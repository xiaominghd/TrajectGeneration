# 从轨迹中分析人群移动模式
## 1、对轨迹进行预处理并白描
---
* 将数据聚合成为“停留点+起始时间+终止时间”的形式。
![image](https://user-images.githubusercontent.com/33551862/168241379-781b189e-0ae4-417c-b51e-2fc5847a00cc.png)
* 展示区域的地理位置和城市特征。观察时间范围内不同城市的流量变化，计算均值-最大值-最小值，并对异常值进行分析
![image](https://user-images.githubusercontent.com/33551862/168242073-bd33b3e0-a700-4cd5-afee-a19b9d053072.png)
---
## 2、挖掘轨迹中的特征（低级特征LMIs）
---
* N_day:某一游客在城市中停留的总天数
* S    :第一次进入该城市到首次离开该城市的间隔，比N_day更精确
* R_g  :移动半径，l_c是轨迹中心的坐标

![image](https://user-images.githubusercontent.com/33551862/168244891-f51eb6f0-b60c-45cc-b255-74ea6eb12be7.png)
* D    :轨迹的直径，轨迹上两点的最远距离
---
## 3、再一次对数据进行处理
---
#### 将数据转化为锚点的形式
    step1 输入停留点形式的轨迹(A -> B -> C -> D -> E)，按照停留时间对停留点进行排序
    step2 对于停留时间最长的A，搜索A附近500m的点E，将A、E聚合为锚点r_1
    step3 将B、C聚合为锚点r_2，将D聚合为锚点r_3
    step4 锚点形式的轨迹为r_1 -> r_2 -> r_3 -> r_1
---
## 4、挖掘轨迹中的特征（高级特征HMIs）
---
* A_1 :轨迹锚点的总数。A_1越大，说明游客的轨迹分布越零散。
* A_2 :游客平均每天访问多少个锚点
* N_od:游客每天在不同锚点之间产生的trip数目
* H_1 :对于一条轨迹中的锚点概率分布，计算熵。

![image](https://user-images.githubusercontent.com/33551862/168253387-665dd064-78e6-4cf9-ad54-f5e3dd200e41.png)
* H_2 :对于一条轨迹中的OD对概率分布，计算熵
---
## 5、通过特征分解得到游客的移动模式
---
### 数据预处理
* 对于某一个体i产生的轨迹，计算以上九个特征，得到向量{x_1 , x_2 , x_3 ... x_9 }
* Min-Max归一化，Min_j和Max_j分别对应在全局范围内第j个特征的最小值/最大值

![image](https://user-images.githubusercontent.com/33551862/168255288-4ac634c1-1a76-4653-aa73-b0d317b4d7a1.png)
* 构造协方差矩阵

![image](https://user-images.githubusercontent.com/33551862/168272124-49569234-f9aa-4982-b5a3-b445f20432a2.png)

### 特征值分解
* 按照特征值从大到小的顺序得到对应的特征向量以及对应的系数矩阵

![image](https://user-images.githubusercontent.com/33551862/168273966-e457df33-2b02-4288-959c-92c71fb1c7cd.png)
#### 关于特征值/特征向量
    1、上述的九个特征可看作一组基底，特征向量是这组基底的线性组合
    2、每一条轨迹又可以由特征向量线性组合而得，参数对应的是特征值
---
## 6、结果分析
---
### 6.1、统计特性
* 基于各个特征的平均值/中位数/方差/分位点进行分析
![image](https://user-images.githubusercontent.com/33551862/168274943-da9f2b15-8979-476b-ae3d-2bd5783ab98b.png)
#### 从数据白描中看出的不同城市游客的行为模式的差异
    * N_day 和 S 显示游客在不同城市的停留时间有差异
    * A_1 和 A_2 显示游客在不同城市的所参观的经典以及产生的旅行轨迹数目有差异
    * D 和R_g 在差距不大，说明城市的大小并不影响游客游览的范围
    * H_1 和H_2表示了游客参与活动的多样性在城市间也具有一定的差异
### 6.2、基于特征值的分析 
* 计算参数总量，以及每一个特征向量对应的值，值越大，该特征对结果的影响越大。只用前两个特征就可以还原轨迹80%的信息

![image](https://user-images.githubusercontent.com/33551862/168282585-06b080c3-78ba-4589-b0c7-35663f6e52ed.png)

* 单独分析前四个特征向量里每一维的值，（特征向量是基底的线性组合，画出折线图）
![image](https://user-images.githubusercontent.com/33551862/168283173-7dec1857-5914-46c6-930d-13b9c8a740fb.png)
#### 结果分析
    1、PC1是最重要的特征，而H_1,H_2,D值较大，说明活动范围以及活动的丰富程度是区分游客移动模式的重要因素
    2、PC1中所有的值都是大于0的，说明每一个特征都能够帮助更好的区分游客的移动模式
    3、图J中D，R_g<0,但是H_1,H_2>0，说明会有一些游客在很小的范围参与了很多的活动，或者是在很大的范围内只参与了少量的活动
    ...
### 6.3 针对特定旅行团体的活动模式分析

 
   
---
